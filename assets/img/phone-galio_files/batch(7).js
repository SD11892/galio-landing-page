;
/* module-key = 'com.atlassian.jira.jira-one-click-invite-plugin:one-click-invite', location = 'templates/sidebar/one-click-invite/one-click-invite.soy' */
// This file was automatically generated from one-click-invite.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Templates.OneClickInvite.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.OneClickInvite == 'undefined') { JIRA.Templates.OneClickInvite = {}; }


JIRA.Templates.OneClickInvite.renderDialog = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog id="one-click-invite-inline-dialog" alignment="left middle" persistent><h3 class="dialog-title">' + soy.$$escapeHtml('Invite your team') + '</h3><p>' + soy.$$filterNoAutoescape(AJS.format('Send an invitation to the people you want to work on your projects.','<br/>')) + '</p><form action="" method="post" class="aui top-label"><fieldset class="top-label"><div class="field-group"><input class="text one-click-invite-email" type="text" id="email-1" placeholder="' + soy.$$escapeHtml('Enter email address') + '" name="email-1"/></div><div class="field-group"><input class="text one-click-invite-email" type="text" id="email-2" placeholder="' + soy.$$escapeHtml('Enter email address') + '" name="email-2"/></div><div class="field-group"><input class="text one-click-invite-email" type="text" id="email-3" placeholder="' + soy.$$escapeHtml('Enter email address') + '" name="email-3"/></div><div id="one-click-invite-people-collection-img"></div><div id="one-click-invite-error-message-container"></div><div class="buttons-container"><div class="buttons"><button id="one-click-invite-dialog-invite-btn" class="aui-button" type="button">' + soy.$$escapeHtml('Invite') + '</button><button id="one-click-invite-dialog-cancel-btn" class="aui-button aui-button-link" type="button">' + soy.$$escapeHtml('Cancel') + '</button><span id="one-click-invite-spinner" class="button-spinner"></span></div></div></fieldset></form></aui-inline-dialog>';
};
if (goog.DEBUG) {
  JIRA.Templates.OneClickInvite.renderDialog.soyTemplateName = 'JIRA.Templates.OneClickInvite.renderDialog';
}


JIRA.Templates.OneClickInvite.renderErrorMessages = function(opt_data, opt_ignored) {
  return '' + aui.message.error({content: '' + soy.$$filterNoAutoescape(opt_data.errorMessageContent)});
};
if (goog.DEBUG) {
  JIRA.Templates.OneClickInvite.renderErrorMessages.soyTemplateName = 'JIRA.Templates.OneClickInvite.renderErrorMessages';
}
;
;
/* module-key = 'com.atlassian.jira.jira-one-click-invite-plugin:one-click-invite', location = 'js/sidebar/one-click-invite/one-click-invite-view.js' */
define("sidebar/oneclickinvite/one-click-invite-view",["backbone","jira/skate","user-management-common/create-user/request-invite","aui/flag","sidebar/oneclickinvite/one-click-invite-error-messages","one-click-invite/uri","underscore","aui/inline-dialog2"],function(e,i,t,n,s,r,a){return e.View.extend({initialize:function(e){this.parent=e.model.parent,this.sidebarLink=e.model.sidebarLink},setElement:function(t){if(t)return e.View.prototype.setElement.call(this,t),i.init(this.el),this},render:function(){var e=document.createElement("div");e.innerHTML=JIRA.Templates.OneClickInvite.renderDialog({}),this.dialog=e.firstChild,this.parent.appendChild(this.dialog),this.setElement(this.dialog),this.sidebarLink.setAttribute("aria-controls","one-click-invite-inline-dialog"),this.sidebarLink.setAttribute("data-aui-trigger",""),this.sidebarLink.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),this.toggleDialog()}.bind(this)),AJS.$(window).on("keydown",function(e){e.which===AJS.$.ui.keyCode.ESCAPE&&this.hideDialog()}.bind(this))},events:{"click #one-click-invite-dialog-invite-btn":function(e){e.preventDefault(),AJS.trigger("analyticsEvent",{name:"invite.user.user.creation.sent",data:{invitationCount:this.getEmailAddresses().length}}),this.setInviteButtonLoading(!0);var i=this.showSuccessFlag.bind(this),n=this.displayErrors.bind(this);t.createUser(this.getEmailAddresses()).done(i).fail(n)},"click #one-click-invite-dialog-cancel-btn":function(e){AJS.trigger("analyticsEvent",{name:"invite.user.dialog.cancelled",data:{invitationCount:this.getEmailAddresses().length}}),this.hideDialog()},"keydown .one-click-invite-email":function(e){13!==e.keyCode&&13!==e.which||AJS.$("#one-click-invite-dialog-invite-btn").trigger("click")}},getEmailAddresses:function(){for(var e=[],i=document.getElementsByClassName("one-click-invite-email"),t=0;t<i.length;t++){var n=i[t].value;n&&e.push(n)}return e},toggleDialog:function(){this.dialog.open?this.hideDialog():(AJS.trigger("analyticsEvent",{name:"invite.user.dialog.opened"}),this.dialog.open=!0)},hideDialog:function(){this.dialog.open=!1,this.sidebarLink.blur(),AJS.$(".one-click-invite-email").val(""),document.getElementById("one-click-invite-error-message-container").innerHTML="",AJS.$(this.dialog).removeClass("has-error")},showSuccessFlag:function(e){AJS.trigger("analyticsEvent",{name:"invite.user.user.creation.success",data:{invitationCount:this.getEmailAddresses().length,createdUsersCount:e.createdUsers.length,existingUsersCount:e.existingActiveUsers.length+e.existingInactiveUsers.length}}),this.setInviteButtonLoading(!1),this.hideDialog(),n({type:"success",close:"auto",body:this.getSuccessMessage(e)})},getSuccessMessage:function(e){var i=e.createdUsers,t=a.map(e.existingActiveUsers.concat(e.existingInactiveUsers),function(e){return e.username});return this.getMessageBasedOnSuccessType(i,t)},getMessageBasedOnSuccessType:function(e,i){var t='<a href="'+r(AJS.contextPath()+"/admin/users").addSearch("n",e.concat(i).join(","))+'">';switch(e.length){case 0:if(1==i.length)return AJS.format("{0} is already a user. To check their permissions, {1}view users and roles{2}.","<b>"+i[0]+"</b>",t,"</a>");if(2==i.length)return AJS.format("{0} and {1} are already users. To check their permissions, {2}view users and roles{3}.","<b>"+i[0]+"</b>","<b>"+i[1]+"</b>",t,"</a>");if(3==i.length)return AJS.format("{0}, {1}, and {2} are already users. To check their permissions, {3}view users and roles{4}.","<b>"+i[0]+"</b>","<b>"+i[1]+"</b>","<b>"+i[2]+"</b>",t,"</a>");break;case 1:return 1==i.length?AJS.format("{0} successfully invited. {1} is already a user. To check their permissions, {2}view users and roles{3}.","<b>"+e[0]+"</b>","<b>"+i[0]+"</b>",t,"</a>"):2==i.length?AJS.format("{0} successfully invited. {1} and {2} are already users.  To check their permissions, {3}view users and roles{4}.","<b>"+e[0]+"</b>","<b>"+i[0]+"</b>","<b>"+i[1]+"</b>",t,"</a>"):AJS.format("{0} successfully invited. To check their permissions, {1}view users and roles{2}.","<b>"+e[0]+"</b>",t,"</a>");case 2:return 1==i.length?AJS.format("{0} and {1} successfully invited. {2} is already a user. To check their permissions, {3}view users and roles{4}.","<b>"+e[0]+"</b>","<b>"+e[1]+"</b>","<b>"+i[0]+"</b>",t,"</a>"):AJS.format("{0} and {1} successfully invited. To check their permissions, {2}view users and roles{3}.","<b>"+e[0]+"</b>","<b>"+e[1]+"</b>",t,"</a>");case 3:return AJS.format("{0}, {1}, and {2} successfully invited. To check their permissions, {3}view users and roles{4}.","<b>"+e[0]+"</b>","<b>"+e[1]+"</b>","<b>"+e[2]+"</b>",t,"</a>")}},displayErrors:function(e){var i=this.getErrorFromResponse(e);this.doAnalyticEventFor(i.statusCode),this.setInviteButtonLoading(!1),AJS.$(this.dialog).addClass("has-error"),document.getElementById("one-click-invite-error-message-container").innerHTML=JIRA.Templates.OneClickInvite.renderErrorMessages({errorMessageContent:this.getErrorMessage(i)})},getErrorMessage:function(e){var i=e.statusCode;if("INVALID_EMAILS"===i){var t=s.INVALID_EMAILS;return 1==e.invalidEmailAddresses.length?t.SINGLE:t.MULTIPLE}return s[i]?s[i]:s.GENERIC_ERROR},getErrorFromResponse:function(e){return 401===e.status?{statusCode:"SESSION_ERROR"}:e.responseText?JSON.parse(e.responseText):{statusCode:"NETWORK_ERROR"}},setInviteButtonLoading:function(e){var i=document.getElementById("one-click-invite-dialog-invite-btn"),t=AJS.$("#one-click-invite-spinner");e?(i.disabled=!0,t.spin()):(i.disabled=!1,t.spinStop())},doAnalyticEventFor:function(e){AJS.trigger("analyticsEvent",{name:"invite.user.user.creation.error.generic",data:{invitationCount:this.getEmailAddresses().length}});var i=e.replace("_",".").toLowerCase();i&&AJS.trigger("analyticsEvent",{name:"invite.user.user.creation.error."+i,data:{invitationCount:this.getEmailAddresses().length}})}})});;
;
/* module-key = 'com.atlassian.jira.jira-one-click-invite-plugin:one-click-invite', location = 'js/sidebar/one-click-invite/one-click-invite.js' */
require(["sidebar/oneclickinvite/one-click-invite-view","jira/skate"],function(e,i){i("one-click-invite-link",{type:i.type.CLASSNAME,created:function(i){var n=new e({model:{parent:document.getElementsByTagName("body")[0],sidebarLink:i}});n.render()}})});;
;
/* module-key = 'com.atlassian.jira.jira-one-click-invite-plugin:one-click-invite', location = 'js/sidebar/one-click-invite/uri.js' */
define("one-click-invite/uri",["atlassian/libs/uri-1.14.1"],function(i){return i});;
;
/* module-key = 'com.atlassian.jira.jira-one-click-invite-plugin:one-click-invite', location = 'js/sidebar/one-click-invite/one-click-invite-error-messages.js' */
define("sidebar/oneclickinvite/one-click-invite-error-messages",[],function(){return OneClickInviteErrorMessages={GENERIC_ERROR:"Something\'s not working. Try inviting people again later.",NETWORK_ERROR:"The network has dropped out. Check your connection and try again.",UNKNOWN_ERROR:"Can\'t connect to the server right now. Try inviting people again later.",NO_EMAIL:"Enter an email address for the person.",SESSION_ERROR:"Too much time passed and you\'ve been logged out. Hit refresh to log in again.",INVALID_EMAILS:{SINGLE:"That email address isn\'t quite right. Try entering it again.",MULTIPLE:"There\'s something wrong with the email addresses. Check them and try again."},LICENSE_EXCEEDED:AJS.format("Looks like you haven\'\'t got enough licenses to invite everyone listed. You can purchase additional licenses through the {0}product upgrade page{1}.",'<a href="'+AJS.contextPath()+'/admin/billing/overview">',"</a>")}});;